{
  "contentVersion": "1.0.0.0",
  "parameters": {
    "workbookDisplayName": {
      "type": "string",
      "defaultValue": "MDTI WORKBOOK",
      "metadata": {
        "description": "The friendly name for the workbook that is used in the Gallery or Saved List.  This name must be unique within a resource group."
      }
    },
    "workbookType": {
      "type": "string",
      "defaultValue": "workbook",
      "metadata": {
        "description": "The gallery that the workbook will been shown under. Supported values include workbook, tsg, etc. Usually, this is 'workbook'"
      }
    },
    "workbookSourceId": {
      "type": "string",
      "defaultValue": "azure monitor",
      "metadata": {
        "description": "The id of resource instance to which the workbook will be associated"
      }
    },
    "workbookId": {
      "type": "string",
      "defaultValue": "[newGuid()]",
      "metadata": {
        "description": "The unique guid for this workbook instance"
      }
    }
  },
  "resources": [
    {
      "name": "[parameters('workbookId')]",
      "type": "microsoft.insights/workbooks",
      "location": "[resourceGroup().location]",
      "apiVersion": "2022-04-01",
      "dependsOn": [],
      "kind": "shared",
      "properties": {
        "displayName": "[parameters('workbookDisplayName')]",
        "serializedData": "{\"version\":\"Notebook/1.0\",\"items\":[{\"type\":1,\"content\":{\"json\":\"# [Microsoft Defender Threat Intelligence Workbook](https://learn.microsoft.com/en-us/defender/threat-intelligence/what-is-microsoft-defender-threat-intelligence-defender-ti) \\r\\n---\\r\\n\\r\\nThe Microsoftâ€™s Defender Threat Intelligence Workbook provides different data feeds to enable network protection and disruption scenarios for MDTI Premium subscribers, and to facilitate remediation of the compromised systems.Within a Security Information and Event Management (SIEM) solution like Microsoft Sentinel, the most commonly used form of CTI is threat indicators, also known as Indicators of Compromise or IoCs. Threat indicators are data that associate observed artifacts such as URLs, file hashes, or IP addresses with known threat activity such as phishing, botnets, or malware. This form of threat intelligence is often called tactical threat intelligence because it can be applied to security products and automation in large scale to detect potential threats to an organization and protect against them. In Microsoft Sentinel, you can use threat indicators to help detect malicious activity observed in your environment and provide context to security investigators to help inform response decisions.\\r\\n\\r\\n**Note** \\r\\n- The workbook visualizes incidents triggered by MDTI within Microsoft Sentinel as well gives the user the opportunity to search IOC information specifically to Hosts and IPs .it will provide crucial information such as **reputation scoring , components , cookies , Trackers and Threat Intelligence details ** that a SOC analyst/ Operator can use to enrich their investigation and Threat hunting scenarios\\r\\n- To leverage the workbook you will require access to an **MDTI Premium license** and the **API license **\\r\\n\\r\\n\\r\\n\"},\"name\":\"text - 11\"},{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"crossComponentResources\":[\"value::all\"],\"parameters\":[{\"id\":\"\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"AzureFunction\",\"label\":\"Deployed-AzureFunction\",\"type\":2,\"isRequired\":true,\"query\":\"resources\\r\\n| where type == \\\"microsoft.web/sites\\\"\\r\\n| where kind == \\\"functionapp\\\"\\r\\n| project name \",\"crossComponentResources\":[\"value::all\"],\"typeSettings\":{\"additionalResourceOptions\":[],\"showDefault\":false},\"timeContext\":{\"durationMs\":86400000},\"queryType\":1,\"resourceType\":\"microsoft.resourcegraph/resources\",\"value\":\"riskiq-89752\"}],\"style\":\"pills\",\"queryType\":1,\"resourceType\":\"microsoft.resourcegraph/resources\"},\"name\":\"parameters - 20\"},{\"type\":11,\"content\":{\"version\":\"LinkItem/1.0\",\"style\":\"tabs\",\"links\":[{\"id\":\"156016fd-8949-4999-839f-2f65066cba1f\",\"cellValue\":\"Nav\",\"linkTarget\":\"parameter\",\"linkLabel\":\"MDTI Sentinel Incident view\",\"subTarget\":\"MdtiSentinel\",\"style\":\"link\"},{\"id\":\"82d66787-1fee-425e-9131-a6c82e9d286b\",\"cellValue\":\"Nav\",\"linkTarget\":\"parameter\",\"linkLabel\":\"HostName Information\",\"subTarget\":\"HostName\",\"preText\":\"host\",\"style\":\"link\"},{\"id\":\"c29687b0-a95a-4956-918b-f4b5305dbdb7\",\"cellValue\":\"Nav\",\"linkTarget\":\"parameter\",\"linkLabel\":\"IP Addresses Information\",\"subTarget\":\"IpAddress\",\"style\":\"link\"},{\"id\":\"e17499b7-c2e1-435b-a345-0e670e990777\",\"cellValue\":\"Nav\",\"linkTarget\":\"parameter\",\"linkLabel\":\"MDTI Articles\",\"subTarget\":\"ArticlesList\",\"style\":\"link\"},{\"id\":\"eafc90de-b06e-42db-b81d-089d5b53a1f1\",\"cellValue\":\"Nav\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Vulnerabilities Information\",\"subTarget\":\"Vulnerabilities\",\"style\":\"link\"},{\"id\":\"316120cc-b90d-4a37-a6d7-6636c3c99560\",\"cellValue\":\"Nav\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Intel Profiles\",\"subTarget\":\"Intels\",\"style\":\"link\"},{\"id\":\"6bb2bfe1-6e0a-4d7b-a269-4dc11d3df053\",\"cellValue\":\"Nav\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Typo Squatting \",\"subTarget\":\"typosquat\",\"style\":\"link\"}]},\"name\":\"links - 2\",\"styleSettings\":{\"showBorder\":true}},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"CustomEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"POST\\\",\\\"url\\\":\\\"https://{AzureFunction}.azurewebsites.net/api/ListIntelProfile?\\\",\\\"contentType\\\":\\\"application/json\\\",\\\"urlParams\\\":[],\\\"transformers\\\":[{\\\"type\\\":\\\"jsonpath\\\",\\\"settings\\\":{\\\"tablePath\\\":\\\"$\\\",\\\"columns\\\":[]}}]}\",\"size\":0,\"title\":\"Sponspor States\",\"queryType\":10,\"visualization\":\"map\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"id\",\"formatter\":5}]},\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"targets\",\"formatter\":18,\"formatOptions\":{\"thresholdsOptions\":\"icons\",\"thresholdsGrid\":[{\"operator\":\"Default\",\"thresholdValue\":null,\"representation\":\"1\",\"text\":\"{0}{1}\"}]}},\"showBorder\":false,\"sortCriteriaField\":\"targets\",\"sortOrderField\":1},\"mapSettings\":{\"locInfo\":\"CountryRegion\",\"locInfoColumn\":\"sponsorStates\",\"sizeAggregation\":\"Sum\",\"legendAggregation\":\"Sum\",\"itemColorSettings\":null}},\"customWidth\":\"25\",\"name\":\"query - 0 - Copy - Copy\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"CustomEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"POST\\\",\\\"url\\\":\\\"https://{AzureFunction}.azurewebsites.net/api/ListIntelProfile?\\\",\\\"contentType\\\":\\\"application/json\\\",\\\"urlParams\\\":[],\\\"transformers\\\":[{\\\"type\\\":\\\"jsonpath\\\",\\\"settings\\\":{\\\"tablePath\\\":\\\"$\\\",\\\"columns\\\":[]}}]}\",\"size\":0,\"title\":\"Intel Profiles List\",\"queryType\":10,\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"id\",\"formatter\":5}],\"filter\":true}},\"customWidth\":\"75\",\"name\":\"query - 0\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"CustomEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"POST\\\",\\\"url\\\":\\\"https://{AzureFunction}.azurewebsites.net/api/ListIntelProfile?\\\",\\\"contentType\\\":\\\"application/json\\\",\\\"urlParams\\\":[],\\\"transformers\\\":[{\\\"type\\\":\\\"jsonpath\\\",\\\"settings\\\":{\\\"tablePath\\\":\\\"$\\\",\\\"columns\\\":[]}}]}\",\"size\":0,\"title\":\"Targeted industry\",\"queryType\":10,\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"id\",\"formatter\":5},{\"columnMatch\":\"firstActiveDateTime\",\"formatter\":5},{\"columnMatch\":\"aliases\",\"formatter\":5},{\"columnMatch\":\"sponsorStates\",\"formatter\":5},{\"columnMatch\":\"summary\",\"formatter\":5},{\"columnMatch\":\"description\",\"formatter\":5},{\"columnMatch\":\"tradecraft\",\"formatter\":5}],\"filter\":true},\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"targets\",\"formatter\":18,\"formatOptions\":{\"thresholdsOptions\":\"icons\",\"thresholdsGrid\":[{\"operator\":\"Default\",\"thresholdValue\":null,\"representation\":\"1\",\"text\":\"{0}{1}\"}]}},\"showBorder\":false,\"sortCriteriaField\":\"targets\",\"sortOrderField\":1}},\"customWidth\":\"25\",\"name\":\"query - 0 - Copy\"}]},\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"Intels\"},\"name\":\"group - 21\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"29e3c12d-0bcb-4c29-a392-bf965921fa95\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"Vulnerability\",\"label\":\"VulnerabilityID\",\"type\":1,\"timeContext\":{\"durationMs\":86400000},\"value\":\"CVE-2021-44228\"}],\"style\":\"pills\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"parameters - 0\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"CustomEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"POST\\\",\\\"url\\\":\\\"https://{AzureFunction}.azurewebsites.net/api/GetArticlesFromVulnerabilities?Vulnerability={Vulnerability}\\\",\\\"contentType\\\":\\\"text/plain\\\",\\\"urlParams\\\":[],\\\"transformers\\\":[{\\\"type\\\":\\\"jsonpath\\\",\\\"settings\\\":{\\\"tablePath\\\":\\\"$.value\\\",\\\"columns\\\":[]}}]}\",\"size\":0,\"title\":\"Vulnerability Tags\",\"queryType\":10,\"visualization\":\"tiles\",\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"tags\",\"formatter\":18,\"formatOptions\":{\"thresholdsOptions\":\"icons\",\"thresholdsGrid\":[{\"operator\":\"Default\",\"thresholdValue\":null,\"representation\":\"3\",\"text\":\"{0}{1}\"}]}},\"showBorder\":true,\"sortCriteriaField\":\"tags\"}},\"customWidth\":\"25\",\"name\":\"query - 4\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"CustomEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"POST\\\",\\\"url\\\":\\\"https://{AzureFunction}.azurewebsites.net/api/GetSingleVulnerability?Vulnerability={Vulnerability}\\\",\\\"contentType\\\":\\\"text/plain\\\",\\\"urlParams\\\":[],\\\"transformers\\\":[{\\\"type\\\":\\\"jsonpath\\\",\\\"settings\\\":{\\\"tablePath\\\":\\\"$\\\",\\\"columns\\\":[]}}]}\",\"size\":0,\"title\":\"Vulnerability Detail\",\"queryType\":10,\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"@odata.context\",\"formatter\":5}]}},\"customWidth\":\"75\",\"name\":\"query - 1\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"CustomEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"POST\\\",\\\"url\\\":\\\"https://{AzureFunction}.azurewebsites.net/api/GetComponentsFromVulnerabilities?Vulnerability={Vulnerability}\\\",\\\"contentType\\\":\\\"application/json\\\",\\\"urlParams\\\":[],\\\"transformers\\\":[{\\\"type\\\":\\\"jsonpath\\\",\\\"settings\\\":{\\\"tablePath\\\":\\\"$.value\\\",\\\"columns\\\":[]}}]}\",\"size\":0,\"title\":\"Components of vulnerability \",\"queryType\":10,\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"id\",\"formatter\":5},{\"columnMatch\":\"name\",\"formatter\":13,\"formatOptions\":{\"linkTarget\":null,\"showIcon\":true}}],\"filter\":true}},\"customWidth\":\"25\",\"name\":\"query - 2\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"CustomEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"POST\\\",\\\"url\\\":\\\"https://{AzureFunction}.azurewebsites.net/api/GetArticlesFromVulnerabilities?Vulnerability={Vulnerability}\\\",\\\"contentType\\\":\\\"application/json\\\",\\\"urlParams\\\":[],\\\"transformers\\\":[{\\\"type\\\":\\\"jsonpath\\\",\\\"settings\\\":{\\\"tablePath\\\":\\\"$.value\\\",\\\"columns\\\":[]}}]}\",\"size\":0,\"title\":\"Identify Articles in relation to Vulnerability\",\"queryType\":10,\"gridSettings\":{\"filter\":true}},\"customWidth\":\"75\",\"name\":\"query - 3\",\"styleSettings\":{\"showBorder\":true}}]},\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"Vulnerabilities\"},\"name\":\"group - 20\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let IP_Data = \\r\\n    external_data(network:string,geoname_id:long,continent_code:string,continent_name:string ,country_iso_code:string,    country_name:string,is_anonymous_proxy:bool,is_satellite_provider:bool)\\r\\n    [@\\\"https://raw.githubusercontent.com/datasets/geoip2-ipv4/master/data/geoip2-ipv4.csv\\\"]\\r\\n    with (ignoreFirstRecord=true, format=\\\"csv\\\");\\r\\nThreatIntelligenceIndicator\\r\\n| extend IPaddress=tostring(NetworkIP)\\r\\n| where isnotempty(IPaddress) \\r\\n| evaluate ipv4_lookup(IP_Data, IPaddress,network)\\r\\n\\r\\n\\r\\n\",\"size\":0,\"title\":\"Threat intelligence IPs pulled by TI\",\"timeContext\":{\"durationMs\":2592000000},\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"\"],\"visualization\":\"tiles\",\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"NetworkIP\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"ConfidenceScore\",\"formatter\":18,\"formatOptions\":{\"thresholdsOptions\":\"colors\",\"thresholdsGrid\":[{\"operator\":\">\",\"thresholdValue\":\"74\",\"representation\":\"redBright\",\"text\":\"{0}{1}\"},{\"operator\":\">\",\"thresholdValue\":\"50\",\"representation\":\"orange\",\"text\":\"{0}{1}\"},{\"operator\":\"Default\",\"thresholdValue\":null,\"text\":\"{0}{1}\"}]},\"numberFormat\":{\"unit\":17,\"options\":{\"style\":\"decimal\",\"maximumFractionDigits\":2,\"maximumSignificantDigits\":3}}},\"showBorder\":true}},\"customWidth\":\"22\",\"name\":\"query - 0\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let IP_Data = \\r\\n    external_data(network:string,geoname_id:long,continent_code:string,continent_name:string ,country_iso_code:string,    country_name:string,is_anonymous_proxy:bool,is_satellite_provider:bool)\\r\\n    [@\\\"https://raw.githubusercontent.com/datasets/geoip2-ipv4/master/data/geoip2-ipv4.csv\\\"]\\r\\n    with (ignoreFirstRecord=true, format=\\\"csv\\\");\\r\\nThreatIntelligenceIndicator\\r\\n| extend IPaddress=tostring(NetworkIP)\\r\\n| where isnotempty(IPaddress) \\r\\n| evaluate ipv4_lookup(IP_Data, IPaddress,network)\",\"size\":0,\"title\":\"Threat indicators Network IPs pulled from MDTI into Sentinel\",\"timeContext\":{\"durationMs\":3542400000,\"endTime\":\"2023-03-14T12:09:00.000Z\"},\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"\"],\"visualization\":\"map\",\"mapSettings\":{\"locInfo\":\"CountryRegion\",\"locInfoColumn\":\"country_name\",\"sizeSettings\":\"ConfidenceScore\",\"sizeAggregation\":\"Sum\",\"legendMetric\":\"ConfidenceScore\",\"legendAggregation\":\"Count\",\"itemColorSettings\":{\"nodeColorField\":\"ConfidenceScore\",\"colorAggregation\":\"Sum\",\"type\":\"heatmap\",\"heatmapPalette\":\"greenRed\"}}},\"customWidth\":\"40\",\"name\":\"query - 1\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let tiObservables = ThreatIntelligenceIndicator\\r\\n    | where TimeGenerated < now()\\r\\n    | project IndicatorId, ThreatType, Description, Active, IndicatorTime = TimeGenerated, Indicator = strcat(NetworkSourceIP, NetworkIP, NetworkDestinationIP, Url, FileHashValue, EmailSourceIpAddress, EmailSenderAddress, DomainName), SourceSystem;\\r\\nlet alertEntity = SecurityAlert \\r\\n    | project parse_json(Entities), SystemAlertId , AlertTime = TimeGenerated\\r\\n    | mvexpand(Entities)\\r\\n    | extend entity = iif(isnotempty(Entities.Address), Entities.Address,\\r\\n                      iif(isnotempty(Entities.HostName),strcat(Entities.HostName, \\\".\\\", Entities.DnsDomain),\\r\\n                      iif(isnotempty(Entities.Url), Entities.Url,\\r\\n                      iif(isnotempty(Entities.Value), Entities.Value,\\r\\n                      iif(Entities.Type == \\\"account\\\", strcat(Entities.Name,\\\"@\\\",Entities.UPNSuffix),\\\"\\\")))))\\r\\n    | where isnotempty(entity) \\r\\n    | project entity, SystemAlertId, AlertTime;\\r\\nlet IncidentAlerts = SecurityIncident\\r\\n    | project IncidentTime = TimeGenerated, IncidentNumber, Title, parse_json(AlertIds)\\r\\n    | mv-expand AlertIds\\r\\n    | project IncidentTime, IncidentNumber, Title, tostring(AlertIds);\\r\\nlet AlertsWithTiObservables = alertEntity\\r\\n    | join kind=inner tiObservables on $left.entity == $right.Indicator;\\r\\nlet IncidentsWithAlertsWithTiObservables = AlertsWithTiObservables\\r\\n    | join kind=inner IncidentAlerts on $left.SystemAlertId == $right.AlertIds;\\r\\nIncidentsWithAlertsWithTiObservables\\r\\n| summarize Incidents=dcount(IncidentNumber), Alerts=dcount(SystemAlertId) by Indicator, ThreatType, Source = SourceSystem, Description\\r\\n| where Source contains \\\"Threat Intelligence\\\" \\r\\n| sort by Incidents, Alerts desc\",\"size\":0,\"title\":\"Threat Intelligence Alerts\",\"timeContext\":{\"durationMs\":2592000000},\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"\"],\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Source\",\"formatter\":18,\"formatOptions\":{\"thresholdsOptions\":\"icons\",\"thresholdsGrid\":[{\"operator\":\"contains\",\"thresholdValue\":\"Microsoft Threat Intelligence Analytics\",\"representation\":\"Noisy\",\"text\":\"{0}{1}\"},{\"operator\":\"contains\",\"thresholdValue\":\"Microsoft Emerging Threat Feed\",\"representation\":\"Important\",\"text\":\"{0}{1}\"},{\"operator\":\"contains\",\"thresholdValue\":\"Microsoft Defender Threat Intelligence\",\"representation\":\"Noisy\",\"text\":\"{0}{1}\"},{\"operator\":\"Default\",\"thresholdValue\":null,\"representation\":null,\"text\":\"{0}{1}\"}]}}]}},\"customWidth\":\"38\",\"name\":\"query - 2\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"BehaviouralEnrichmentMDTI_CL \\r\\n| extend Score = toint(Score_s)\\r\\n| extend MDTILink = strcat(\\\"https://ti.defender.microsoft.com/search?query=\\\",SourceIP)\\r\\n| project SourceIP, Score, classification_s, rules_s, _ActivityType_s, _DesitnationDevice_s, MDTILink\",\"size\":0,\"title\":\"UEBA Behaviour Analytics Anomalies Reputation Scoring\",\"timeContext\":{\"durationMs\":86400000},\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"\"],\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Score\",\"formatter\":18,\"formatOptions\":{\"thresholdsOptions\":\"colors\",\"thresholdsGrid\":[{\"operator\":\">\",\"thresholdValue\":\"70\",\"representation\":\"redBright\",\"text\":\"{0}{1}\"},{\"operator\":\">\",\"thresholdValue\":\"50\",\"representation\":\"orange\",\"text\":\"{0}{1}\"},{\"operator\":\"Default\",\"thresholdValue\":null,\"text\":\"{0}{1}\"}]}},{\"columnMatch\":\"_DesitnationDevice_s\",\"formatter\":18,\"formatOptions\":{\"linkColumn\":\"_DesitnationDevice_s\",\"linkTarget\":\"Resource\",\"thresholdsOptions\":\"icons\",\"thresholdsGrid\":[{\"representation\":\"ResourceFlat\",\"text\":\"{0}{1}\"},{\"operator\":\"Default\",\"thresholdValue\":null,\"representation\":\"ResourceFlat\",\"text\":\"{0}{1}\"}]}},{\"columnMatch\":\"MDTILink\",\"formatter\":7,\"formatOptions\":{\"linkTarget\":\"Url\"}}]}},\"customWidth\":\"50\",\"name\":\"query - 6\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SecurityIncident\\r\\n| extend SystemAlertId = tostring(AlertIds[0])\\r\\n| join (SecurityAlert \\r\\n| where Entities <> \\\"\\\"\\r\\n| mv-expand parse_json(Entities)\\r\\n| where Entities != \\\"\\\"\\r\\n| project SystemAlertId, Entities\\r\\n) on SystemAlertId\\r\\n| where Title == \\\"Microsoft Threat Intelligence Analytics\\\"\\r\\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\\r\\n| parse IncidentUrl with * '/#asset/Microsoft_Azure_Security_Insights/Incident' IncidentBlade\\r\\n| extend SeverityRank=iff(Severity == \\\"High\\\", 3, iff(Severity == \\\"Medium\\\", 2, iff(Severity == \\\"Low\\\", 1, iff(Severity == \\\"Informational\\\", 0, 0))))\\r\\n| sort by SeverityRank, IncidentNumber desc\\r\\n| project Title, IncidentNumber, Severity, IncidentUrl, FirstActivityTime, IncidentBlade, Entities\\r\\n| limit 2500\",\"size\":0,\"title\":\"Incident Trigger with MDTI Analytic Rule\",\"timeContext\":{\"durationMs\":2592000000},\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"\"],\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Severity\",\"formatter\":18,\"formatOptions\":{\"thresholdsOptions\":\"colors\",\"thresholdsGrid\":[{\"operator\":\"contains\",\"thresholdValue\":\"Medium\",\"representation\":\"orange\",\"text\":\"{0}{1}\"},{\"operator\":\"contains\",\"thresholdValue\":\"High\",\"representation\":\"redBright\",\"text\":\"{0}{1}\"},{\"operator\":\"Default\",\"thresholdValue\":null,\"text\":\"{0}{1}\"}]}},{\"columnMatch\":\"IncidentUrl\",\"formatter\":7,\"formatOptions\":{\"linkTarget\":\"Url\"}}]}},\"customWidth\":\"50\",\"name\":\"query - 4\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let DomainQuery=view() { \\r\\nThreatIntelligenceIndicator\\r\\n| summarize arg_max(TimeGenerated, *) by IndicatorId\\r\\n| where isnotempty(DomainName)\\r\\n| summarize SourceSystemArray=make_set(SourceSystem) by DomainName\\r\\n| summarize count() by tostring(SourceSystemArray)\\r\\n| project SourceSystemArray, count_, EntryType=\\\"DomainEntry\\\"\\r\\n};\\r\\nlet UrlQuery=view(){\\r\\nThreatIntelligenceIndicator\\r\\n| summarize arg_max(TimeGenerated, *) by IndicatorId\\r\\n| where isnotempty(Url)\\r\\n| summarize SourceSystemArray=make_set(SourceSystem) by Url\\r\\n| summarize count() by tostring(SourceSystemArray)\\r\\n| project SourceSystemArray, count_, EntryType=\\\"UrlEntry\\\"\\r\\n};\\r\\nlet FileHashQuery=view(){\\r\\nThreatIntelligenceIndicator\\r\\n| summarize arg_max(TimeGenerated, *) by IndicatorId\\r\\n| where isnotempty(FileHashValue)\\r\\n| summarize SourceSystemArray=make_set(SourceSystem) by FileHashValue\\r\\n| summarize count() by tostring(SourceSystemArray)\\r\\n| project SourceSystemArray, count_, EntryType=\\\"FileHashEntry\\\"\\r\\n};\\r\\nlet IPQuery=view(){\\r\\nThreatIntelligenceIndicator\\r\\n| summarize arg_max(TimeGenerated, *) by IndicatorId\\r\\n| where isnotempty(NetworkIP) or isnotempty(NetworkSourceIP)\\r\\n| summarize SourceSystemArray=make_set(SourceSystem) by NetworkIP, NetworkSourceIP\\r\\n| summarize count() by tostring(SourceSystemArray)\\r\\n| project SourceSystemArray, count_, EntryType=\\\"IPEntry\\\"\\r\\n};\\r\\nlet EmailAddressQuery=view(){\\r\\nThreatIntelligenceIndicator\\r\\n| summarize arg_max(TimeGenerated, *) by IndicatorId\\r\\n| where isnotempty(EmailSenderAddress)\\r\\n| summarize SourceSystemArray=make_set(SourceSystem) by EmailSenderAddress\\r\\n| summarize count() by tostring(SourceSystemArray)\\r\\n| project SourceSystemArray, count_, EntryType=\\\"EmailAddressEntry\\\"\\r\\n};\\r\\nlet EmailMessageQuery=view(){\\r\\nThreatIntelligenceIndicator\\r\\n| summarize arg_max(TimeGenerated, *) by IndicatorId\\r\\n| where isnotempty(EmailSubject)\\r\\n| summarize SourceSystemArray=make_set(SourceSystem) by EmailSubject\\r\\n| summarize count() by tostring(SourceSystemArray)\\r\\n| project SourceSystemArray, count_, EntryType=\\\"EmailMessageEntry\\\"\\r\\n};\\r\\nlet SingleSourceIndicators=view(){\\r\\n    DomainQuery\\r\\n    | union UrlQuery\\r\\n    | union FileHashQuery\\r\\n    | union IPQuery\\r\\n    | union EmailAddressQuery\\r\\n    | union EmailMessageQuery\\r\\n    | where array_length(todynamic(SourceSystemArray))==1\\r\\n    | summarize sum(count_) by SourceSystemArray\\r\\n    | extend counter=1 \\r\\n};\\r\\nlet MultipleSourceIndicators=view(){\\r\\n    DomainQuery\\r\\n    | union UrlQuery\\r\\n    | union FileHashQuery\\r\\n    | union IPQuery\\r\\n    | union EmailAddressQuery\\r\\n    | union EmailMessageQuery\\r\\n    | where array_length(todynamic(SourceSystemArray))!=1\\r\\n    | summarize sum(count_) by SourceSystemArray\\r\\n    | extend counter=1\\r\\n};\\r\\nlet CountOfActiveIndicatorsBySource=view(){\\r\\n    ThreatIntelligenceIndicator\\r\\n\\t| summarize arg_max(TimeGenerated, *) by IndicatorId\\r\\n    | where ExpirationDateTime > now() and Active == true\\r\\n    | summarize count() by SourceSystem\\r\\n    | project SourceSystem, count_\\r\\n};\\r\\nSingleSourceIndicators\\r\\n| join kind=fullouter MultipleSourceIndicators on counter \\r\\n| where SourceSystemArray contains todynamic(SourceSystemArray)[0] \\r\\n| order by SourceSystemArray\\r\\n| extend solitary_count=sum_count_\\r\\n| summarize shared_count = sum(sum_count_1) by SourceSystemArray, solitary_count\\r\\n| extend total_count = shared_count + solitary_count\\r\\n| extend unique_percentage = round(toreal(solitary_count)/toreal(total_count)*100, 1)\\r\\n| extend IndicatorSource = tostring(todynamic(SourceSystemArray)[0])\\r\\n| join kind=inner CountOfActiveIndicatorsBySource on $left.IndicatorSource == $right.SourceSystem\\r\\n| order by unique_percentage desc\\r\\n| project Source=IndicatorSource, UniquenessPercentage=unique_percentage, ActiveIndicators = count_\",\"size\":0,\"title\":\"Uniqueness of Threat Intelligence Sources\",\"timeContext\":{\"durationMs\":86400000},\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"\"],\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Source\",\"formatter\":18,\"formatOptions\":{\"thresholdsOptions\":\"icons\",\"thresholdsGrid\":[{\"operator\":\"Default\",\"thresholdValue\":null,\"representation\":\"View\",\"text\":\"{0}{1}\"}]}},{\"columnMatch\":\"ActiveIndicators\",\"formatter\":4,\"formatOptions\":{\"palette\":\"blue\"}}]}},\"customWidth\":\"50\",\"name\":\"query - 5\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"ThreatIntelligenceIndicator\\r\\n| where SourceSystem contains \\\"Microsoft Threat Intelligence Analytics\\\"\\r\\n|project ConfidenceScore, Description, DomainName, NetworkIP\",\"size\":0,\"title\":\"Threat indicators pulled from MDTI\",\"timeContext\":{\"durationMs\":2592000000},\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"\"],\"gridSettings\":{\"sortBy\":[{\"itemKey\":\"Description\",\"sortOrder\":1}]},\"sortBy\":[{\"itemKey\":\"Description\",\"sortOrder\":1}]},\"customWidth\":\"50\",\"name\":\"query - 3\",\"styleSettings\":{\"showBorder\":true}}]},\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"MdtiSentinel\"},\"name\":\"group - 15\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"c1c7c7a9-11c3-41e6-bd65-c74e13b5214e\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"article\",\"label\":\"Article ID\",\"type\":1,\"timeContext\":{\"durationMs\":86400000},\"value\":\"e0c5c210\"}],\"style\":\"pills\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"parameters - 1\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"CustomEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"POST\\\",\\\"url\\\":\\\"https://{AzureFunction}.azurewebsites.net/api/GetSingleArticle?article={article}\\\",\\\"contentType\\\":\\\"application/json\\\",\\\"urlParams\\\":[],\\\"transformers\\\":[{\\\"type\\\":\\\"jsonpath\\\",\\\"settings\\\":{\\\"tablePath\\\":\\\"$\\\",\\\"columns\\\":[]}}]}\",\"size\":0,\"title\":\"Article infrormation\",\"queryType\":10,\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"imageUrl\",\"formatter\":7,\"formatOptions\":{\"linkTarget\":\"Url\"}},{\"columnMatch\":\"Url\",\"formatter\":7,\"formatOptions\":{\"linkTarget\":\"Url\"}}]}},\"customWidth\":\"75\",\"name\":\"query - 2\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"CustomEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"POST\\\",\\\"url\\\":\\\"https://{AzureFunction}.azurewebsites.net/api/GetIndictorFromArticle?article={article}\\\",\\\"contentType\\\":\\\"application/json\\\",\\\"urlParams\\\":[],\\\"transformers\\\":[{\\\"type\\\":\\\"jsonpath\\\",\\\"settings\\\":{\\\"tablePath\\\":\\\"$.value\\\",\\\"columns\\\":[{\\\"path\\\":\\\"$.artifact\\\",\\\"columnid\\\":\\\"IOCtypeIOCValue\\\",\\\"substringRegexMatch\\\":\\\"@{@odata\\\\\\\\.type=#microsoft\\\\\\\\.graph\\\\\\\\.security.\\\",\\\"substringReplace\\\":\\\"  \\\"}]}}]}\",\"size\":0,\"title\":\"Article indicators\",\"queryType\":10,\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"id\",\"formatter\":5},{\"columnMatch\":\"source\",\"formatter\":5}]},\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"tags\"},\"showBorder\":false}},\"customWidth\":\"25\",\"name\":\"query - 2 - Copy\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"CustomEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"POST\\\",\\\"url\\\":\\\"https://{AzureFunction}.azurewebsites.net/api/ListArticles\\\",\\\"contentType\\\":\\\"application/json\\\",\\\"urlParams\\\":[],\\\"transformers\\\":[{\\\"type\\\":\\\"jsonpath\\\",\\\"settings\\\":{\\\"tablePath\\\":\\\"$\\\",\\\"columns\\\":[]}}]}\",\"size\":0,\"title\":\"List of MDTI Articles\",\"queryType\":10,\"gridSettings\":{\"filter\":true},\"sortBy\":[]},\"name\":\"query - 0\",\"styleSettings\":{\"showBorder\":true}}]},\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"ArticlesList\"},\"name\":\"group - 19\"},{\"type\":1,\"content\":{\"json\":\"Web components are details describing a webÂ page or a server infrastructure. This data isÂ generated by performing web crawling and portÂ scanning. These components allow a user toÂ understand the makeup of a webpage or theÂ technology and services driving a specific piece ofÂ infrastructure.Â Â \\r\\n**Questions this data set may help answer:**\\r\\n- What vulnerable infrastructure are you using?\\r\\n- What unique web components is the threat actor using that can track them to other domains?\\r\\n- Are any components marked as malicious?\\r\\n- What is the number of web components identified?\\r\\n- Are there any unique or strange technologies not often seen?\\r\\n- Are there any fake versions of specific technologies?\\r\\n- What is the frequency of changes in web componentsâ€“often or rarely done?\\r\\n- Are there any suspicious libraries known to be abused?\\r\\n- Are there any technologies with vulnerabilities associated with them?\\r\\n\\r\\n\",\"style\":\"info\"},\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"Hostcomponents\"},\"name\":\"text - 14\"},{\"type\":1,\"content\":{\"json\":\"Trackers are unique codes or values found within web pages and often used to track user interaction. These codes can be used to correlate a disparate group of websites to a central entity. Often, actors will copy the source code of a victimâ€™s website they are looking to impersonate for a phishing campaign. Seldomly will actors take the time to remove these IDs that allow users to identify these fraudulent sites using Microsoftâ€™s Trackers data set. Actors may also deploy tracker IDs to see how successful their cyber-attack campaigns are. This is similar to marketers when they leverage SEO IDs, such as a Google Analytics Tracker ID, to track the success of their marketing campaign.\\r\\n\\r\\n**Questions this data set may help answer:**\\r\\n- Are there other resources using the same analytics IDs?\\r\\n- Are these resources associated with the organization, or are they attempting to conduct an infringement attack?\\r\\n- Is there any overlap between trackersâ€“are they shared with other websites?\\r\\n- What are the types of trackers found within the web page?\\r\\n- What is the length of time for trackers?\\r\\n- What is the frequency of change for tracker valuesâ€“ do they come, go, or remain?\\r\\n- Are there any trackers linking to website cloning software (MarkOfTheWeb or HTTrack)?\\r\\n- Are there any trackers linking to malicious C2 server malware (JARM)?\",\"style\":\"info\"},\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"hostnametrackers\"},\"name\":\"text - 13\"},{\"type\":1,\"content\":{\"json\":\"Cookies are small pieces of data sent from a server to a client as the user browses the internet. These values sometimes contain a state for the application or little bits of tracking data. Defender TI highlights and indexes cookie names observed when crawling a website and allows users to dig into everywhere we have observed specific cookie names across its crawling and data collection. Cookies are also used by malicious actors to keep track of infected victims or store data to be used later.\\r\\n\\r\\n**Our cookie data includes the following:**\\r\\n- What other websites are issuing the same cookies?\\r\\n- What other websites are tracking the same cookies?Â \\r\\n- Does the cookie domain match your query?\\r\\n- What is the number of cookies associated with the artifact?\\r\\n- Are there unique cookie names or domains?\\r\\n- What are the time periods associated with cookies?\\r\\n- What is the frequency of newly observed cookies or changes associated with cookies?\\r\\n\",\"style\":\"info\"},\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"hostcookies\"},\"name\":\"text - 12\"},{\"type\":1,\"content\":{\"json\":\"**TypoSquating Use Case**\\r\\n\\r\\nPowered by Opensource typosquating tools( DNS Twister and Open Squat), we are pulling in information of potential TypoSquats in line with your specified Keywords , domain names that could potentially mislead users into phishing campaign activity. What is being visualized is the Daily generated results accompanied by reputational data , length of time and additional scoring that can help with a proactive approach to managing threats \",\"style\":\"info\"},\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"typosquat\"},\"name\":\"text - 16\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"OpenSquat_CL\\r\\n| extend Score = toint(Score_s)\\r\\n| extend TIlink=strcat(\\\"https://ti.defender.microsoft.com/search?query=\\\",Domains_s)\\r\\n//| distinct Item_s,Classification_s, Score,Rules_s, TIlink \\r\\n//| distinct Item_s\\r\\n| project Domains_s, classification_s, Score,rules_s, TIlink \\r\\n| sort by Score\",\"size\":0,\"title\":\"Typosquating Powered by Open SQuat\",\"timeContext\":{\"durationMs\":2592000000},\"showRefreshButton\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"\"],\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Score\",\"formatter\":18,\"formatOptions\":{\"thresholdsOptions\":\"colors\",\"thresholdsGrid\":[{\"operator\":\">\",\"thresholdValue\":\"70\",\"representation\":\"redBright\",\"text\":\"{0}{1}\"},{\"operator\":\">\",\"thresholdValue\":\"50\",\"representation\":\"orange\",\"text\":\"{0}{1}\"},{\"operator\":\"Default\",\"thresholdValue\":null,\"text\":\"{0}{1}\"}]}},{\"columnMatch\":\"TIlink\",\"formatter\":7,\"formatOptions\":{\"linkTarget\":\"Url\"}}],\"filter\":true}},\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"typosquat\"},\"name\":\"query - 17\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"1.0.0\\\",\\\"content\\\":\\\"{\\\\r\\\\n\\\\\\\"hoatname\\\\\\\":\\\\\\\"{hostname}\\\\\\\"\\\\r\\\\n}\\\",\\\"transformers\\\":null}\",\"size\":0,\"exportFieldName\":\"hostname\",\"exportParameterName\":\"hostname\",\"queryType\":8},\"conditionalVisibility\":{\"parameterName\":\"y\",\"comparison\":\"isEqualTo\",\"value\":\"n\"},\"name\":\"query - 3\"}]},\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"HostName\"},\"name\":\"group - 2\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"f04ba5f4-a808-4ce1-b90f-bf09a9b95f09\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"ipaddress\",\"type\":1,\"isGlobal\":true,\"timeContext\":{\"durationMs\":86400000},\"value\":\"104.168.158.159\"}],\"style\":\"pills\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"IpAddress\"},\"name\":\"parameters - 1\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"1.0.0\\\",\\\"content\\\":\\\"{\\\\r\\\\n\\\\\\\"ipaddress\\\\\\\":\\\\\\\"{ipaddress}\\\\\\\"\\\\r\\\\n}\\\",\\\"transformers\\\":null}\",\"size\":0,\"exportFieldName\":\"ipaddress\",\"exportParameterName\":\"ipaddress\",\"exportToExcelOptions\":\"all\",\"queryType\":8},\"conditionalVisibility\":{\"parameterName\":\"y\",\"comparison\":\"isEqualTo\",\"value\":\"n\"},\"name\":\"query - 3\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"CustomEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"GET\\\",\\\"url\\\":\\\"https://{AzureFunction}.azurewebsites.net/api/ReputationforIPAddress?Ipaddress='{ipaddress}'\\\",\\\"contentType\\\":\\\"application/json\\\",\\\"urlParams\\\":[],\\\"transformers\\\":[{\\\"type\\\":\\\"jsonpath\\\",\\\"settings\\\":{\\\"tablePath\\\":\\\"$\\\",\\\"columns\\\":[{\\\"path\\\":\\\"$.classification\\\",\\\"columnid\\\":\\\"Classification\\\",\\\"columnType\\\":\\\"string\\\"},{\\\"path\\\":\\\"$.score\\\",\\\"columnid\\\":\\\"Score\\\",\\\"columnType\\\":\\\"long\\\"}]}}]}\",\"size\":4,\"queryType\":10,\"visualization\":\"tiles\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Score\",\"formatter\":8,\"formatOptions\":{\"min\":0,\"max\":100,\"palette\":\"greenRed\"}}]},\"sortBy\":[],\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"Classification\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Score\",\"formatter\":18,\"formatOptions\":{\"thresholdsOptions\":\"colors\",\"thresholdsGrid\":[{\"operator\":\">\",\"thresholdValue\":\"70\",\"representation\":\"redBright\",\"text\":\"{0}{1}\"},{\"operator\":\">\",\"thresholdValue\":\"50\",\"representation\":\"orange\",\"text\":\"{0}{1}\"},{\"operator\":\"Default\",\"thresholdValue\":null,\"text\":\"{0}{1}\"}],\"compositeBarSettings\":{\"labelText\":\"\",\"columnSettings\":[]}},\"numberFormat\":{\"unit\":17,\"options\":{\"style\":\"decimal\",\"maximumFractionDigits\":2,\"maximumSignificantDigits\":3}}},\"showBorder\":true,\"sortCriteriaField\":\"Score\",\"sortOrderField\":2,\"size\":\"auto\"}},\"customWidth\":\"15\",\"name\":\"query - 3 - Copy\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"CustomEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"POST\\\",\\\"url\\\":\\\"https://{AzureFunction}.azurewebsites.net/api/IPAddressInformation?ipadress='{ipaddress}'\\\",\\\"contentType\\\":\\\"application/json\\\",\\\"urlParams\\\":[],\\\"transformers\\\":[{\\\"type\\\":\\\"jsonpath\\\",\\\"settings\\\":{\\\"tablePath\\\":\\\"$\\\",\\\"columns\\\":[{\\\"path\\\":\\\"$.id\\\",\\\"columnid\\\":\\\"name\\\"},{\\\"path\\\":\\\"$.firstSeenDateTime\\\",\\\"columnid\\\":\\\"firstSeenDateTime\\\"},{\\\"path\\\":\\\"$.lastSeenDateTime\\\",\\\"columnid\\\":\\\"lastSeenDateTime\\\"},{\\\"path\\\":\\\"$.countryOrRegion\\\",\\\"columnid\\\":\\\"countryOrRegion\\\"},{\\\"path\\\":\\\"$.netblock\\\",\\\"columnid\\\":\\\"netblock\\\"},{\\\"path\\\":\\\"$.hostingProvider\\\",\\\"columnid\\\":\\\"hostingProvider\\\"},{\\\"path\\\":\\\"$.autonomousSystem.name\\\",\\\"columnid\\\":\\\"ASN_name\\\"},{\\\"path\\\":\\\"$.autonomousSystem.number\\\",\\\"columnid\\\":\\\"ASN_number\\\"},{\\\"path\\\":\\\"$.autonomousSystem.organization\\\",\\\"columnid\\\":\\\"ASN_organization\\\"},{\\\"path\\\":\\\"$.autonomousSystem.value\\\",\\\"columnid\\\":\\\"ASN_value\\\"}]}}]}\",\"size\":0,\"exportToExcelOptions\":\"all\",\"queryType\":10,\"visualization\":\"map\",\"sortBy\":[],\"mapSettings\":{\"locInfo\":\"CountryRegion\",\"locInfoColumn\":\"countryOrRegion\",\"sizeSettings\":\"ASN_number\",\"sizeAggregation\":\"Count\",\"legendMetric\":\"ASN_number\",\"legendAggregation\":\"Count\",\"itemColorSettings\":{\"nodeColorField\":\"ASN_number\",\"colorAggregation\":\"Sum\",\"type\":\"heatmap\",\"heatmapPalette\":\"greenRed\"},\"numberFormatSettings\":{\"unit\":0,\"options\":{\"style\":\"decimal\"}}}},\"customWidth\":\"30\",\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"IpAddress\"},\"name\":\"query - 1 - Copy\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"CustomEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"POST\\\",\\\"url\\\":\\\"https://{AzureFunction}.azurewebsites.net/api/ComponentsForIPAddress?ipaddress='{ipaddress}'\\\",\\\"contentType\\\":\\\"application/json\\\",\\\"urlParams\\\":[],\\\"transformers\\\":[{\\\"type\\\":\\\"jsonpath\\\",\\\"settings\\\":{\\\"tablePath\\\":\\\"$.value\\\",\\\"columns\\\":[]}}]}\",\"size\":1,\"title\":\"Components\",\"exportToExcelOptions\":\"all\",\"queryType\":10,\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"id\",\"formatter\":5},{\"columnMatch\":\"name\",\"formatter\":18,\"formatOptions\":{\"thresholdsOptions\":\"colors\",\"thresholdsGrid\":[{\"operator\":\"contains\",\"thresholdValue\":\"Crypto\",\"representation\":\"redBright\",\"text\":\"{0}{1}\"},{\"operator\":\"Default\",\"thresholdValue\":null,\"text\":\"{0}{1}\"}]}},{\"columnMatch\":\"category\",\"formatter\":18,\"formatOptions\":{\"thresholdsOptions\":\"colors\",\"thresholdsGrid\":[{\"operator\":\"contains\",\"thresholdValue\":\"Command and Control Server\",\"representation\":\"redBright\",\"text\":\"{0}{1}\"},{\"operator\":\"Default\",\"thresholdValue\":null,\"text\":\"{0}{1}\"}]}},{\"columnMatch\":\"TiLink\",\"formatter\":1,\"formatOptions\":{\"linkColumn\":\"name\",\"linkTarget\":\"Url\"},\"numberFormat\":{\"unit\":0,\"options\":{\"style\":\"decimal\"},\"emptyValCustomText\":\"https://prod.ti.trafficmanager.net/search/components/ips?category=JavaScript%20Library&query=CryptoJS&version=\"}}],\"filter\":true},\"sortBy\":[]},\"customWidth\":\"55\",\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"IpAddress\"},\"name\":\"query - 1 - Copy\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"CustomEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"POST\\\",\\\"url\\\":\\\"https://{AzureFunction}.azurewebsites.net/api/IPAddressInformation?ipadress='{ipaddress}'\\\",\\\"contentType\\\":\\\"application/json\\\",\\\"urlParams\\\":[],\\\"transformers\\\":[{\\\"type\\\":\\\"jsonpath\\\",\\\"settings\\\":{\\\"tablePath\\\":\\\"$\\\",\\\"columns\\\":[{\\\"path\\\":\\\"$.id\\\",\\\"columnid\\\":\\\"name\\\"},{\\\"path\\\":\\\"$.firstSeenDateTime\\\",\\\"columnid\\\":\\\"firstSeenDateTime\\\"},{\\\"path\\\":\\\"$.lastSeenDateTime\\\",\\\"columnid\\\":\\\"lastSeenDateTime\\\"},{\\\"path\\\":\\\"$.countryOrRegion\\\",\\\"columnid\\\":\\\"countryOrRegion\\\"},{\\\"path\\\":\\\"$.netblock\\\",\\\"columnid\\\":\\\"netblock\\\"},{\\\"path\\\":\\\"$.hostingProvider\\\",\\\"columnid\\\":\\\"hostingProvider\\\"},{\\\"path\\\":\\\"$.autonomousSystem.name\\\",\\\"columnid\\\":\\\"ASN_name\\\"},{\\\"path\\\":\\\"$.autonomousSystem.number\\\",\\\"columnid\\\":\\\"ASN_number\\\"},{\\\"path\\\":\\\"$.autonomousSystem.organization\\\",\\\"columnid\\\":\\\"ASN_organization\\\"},{\\\"path\\\":\\\"$.autonomousSystem.value\\\",\\\"columnid\\\":\\\"ASN_value\\\"}]}}]}\",\"size\":1,\"title\":\"IP Address Information\",\"exportToExcelOptions\":\"all\",\"queryType\":10,\"gridSettings\":{\"filter\":true},\"sortBy\":[]},\"customWidth\":\"45\",\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"IpAddress\"},\"name\":\"query - 1\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"CustomEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"POST\\\",\\\"url\\\":\\\"https://{AzureFunction}.azurewebsites.net/api/ReputationforIPAddress?Ipaddress='{ipaddress}'\\\",\\\"contentType\\\":\\\"application/json\\\",\\\"urlParams\\\":[],\\\"transformers\\\":[{\\\"type\\\":\\\"jsonpath\\\",\\\"settings\\\":{\\\"tablePath\\\":\\\"$.rules\\\",\\\"columns\\\":[]}}]}\",\"size\":1,\"title\":\"MDTI Threat Intelligence Details\",\"exportToExcelOptions\":\"all\",\"queryType\":10,\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"severity\",\"formatter\":18,\"formatOptions\":{\"thresholdsOptions\":\"colors\",\"thresholdsGrid\":[{\"operator\":\"contains\",\"thresholdValue\":\"medium\",\"representation\":\"orange\",\"text\":\"{0}{1}\"},{\"operator\":\"contains\",\"thresholdValue\":\"low\",\"text\":\"{0}{1}\"},{\"operator\":\"contains\",\"thresholdValue\":\"high\",\"representation\":\"redBright\",\"text\":\"{0}{1}\"},{\"operator\":\"Default\",\"thresholdValue\":null,\"text\":\"{0}{1}\"}]}},{\"columnMatch\":\"relatedDetailsUrl\",\"formatter\":7,\"formatOptions\":{\"linkTarget\":\"Url\"}},{\"columnMatch\":\"link\",\"formatter\":7,\"formatOptions\":{\"linkTarget\":\"Url\"}}],\"filter\":true},\"sortBy\":[]},\"customWidth\":\"55\",\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"IpAddress\"},\"name\":\"query - 1 - Copy\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"CustomEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"POST\\\",\\\"url\\\":\\\"https://{AzureFunction}.azurewebsites.net/api/CookiesIPAddress?ipaddress='{ipaddress}'\\\",\\\"contentType\\\":\\\"application/json\\\",\\\"urlParams\\\":[],\\\"transformers\\\":[{\\\"type\\\":\\\"jsonpath\\\",\\\"settings\\\":{\\\"tablePath\\\":\\\"$.value\\\",\\\"columns\\\":[]}}]}\",\"size\":1,\"title\":\"IP Address Cookies infromation\",\"queryType\":10},\"customWidth\":\"45\",\"name\":\"query - 8\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"CustomEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"POST\\\",\\\"url\\\":\\\"https://{AzureFunction}.azurewebsites.net/api/TrackersforIPAddress?ipaddress='{ipaddress}'\\\",\\\"contentType\\\":\\\"application/json\\\",\\\"urlParams\\\":[],\\\"transformers\\\":[{\\\"type\\\":\\\"jsonpath\\\",\\\"settings\\\":{\\\"tablePath\\\":\\\"$.value\\\",\\\"columns\\\":[]}}]}\",\"size\":1,\"title\":\"IP Address Trackers information\",\"queryType\":10,\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"kind\",\"formatter\":18,\"formatOptions\":{\"thresholdsOptions\":\"colors\",\"thresholdsGrid\":[{\"operator\":\"contains\",\"thresholdValue\":\"Jarm\",\"representation\":\"redBright\",\"text\":\"{0}{1}\"},{\"operator\":\"contains\",\"thresholdValue\":\"Markoftheweb\",\"representation\":\"red\",\"text\":\"{0}{1}\"},{\"operator\":\"Default\",\"thresholdValue\":null,\"text\":\"{0}{1}\"}]}}]}},\"customWidth\":\"55\",\"name\":\"query - 9\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let ThreatIntel =  ThreatIntelligenceIndicator\\r\\n| where isnotempty(NetworkSourceIP)\\r\\n| project  ip= NetworkSourceIP;\\r\\nunion isfuzzy=true\\r\\n (\\r\\n    // Search for device click events\\r\\n    ThreatIntel\\r\\n    | join kind=inner (\\r\\n        CloudAppEvents\\r\\n        | where isnotempty( IPAddress)\\r\\n        | summarize by IPAddress ,Type , TimeGenerated\\r\\n    ) on $left.ip == $right.IPAddress\\r\\n    | project ip, Type, TimeGenerated\\r\\n),\\r\\n (\\r\\n    // BrowserLaunchedToOpenUrl, SmartScreenUrlWarning, ExploitGuardNetworkProtectionBlocked\\r\\n    ThreatIntel\\r\\n    | join kind=inner (\\r\\n        CommonSecurityLog\\r\\n        | where isnotempty( DestinationIP)\\r\\n                | summarize by DestinationIP , Type,TimeGenerated\\r\\n    ) on $left.ip == $right.DestinationIP\\r\\n        | project ip, Type, TimeGenerated\\r\\n),\\r\\n(\\r\\n    ThreatIntel\\r\\n    | join kind=inner (\\r\\n        DnsEvents\\r\\n        | where isnotempty( IPAddresses)\\r\\n                | summarize by IPAddresses , Type, TimeGenerated\\r\\n    ) on $left.ip == $right.IPAddresses \\r\\n        | project ip, Type, TimeGenerated\\r\\n    ),   \\r\\n    (\\r\\n    ThreatIntel\\r\\n    | join kind=inner (\\r\\n        SecurityEvent\\r\\n        | where isnotempty( IpAddress)\\r\\n                | summarize by IpAddress , Type, TimeGenerated\\r\\n    ) on $left.ip == $right.IpAddress\\r\\n        | project ip, Type, TimeGenerated\\r\\n    ),\\r\\n  (\\r\\n    ThreatIntel\\r\\n    | join kind=inner (\\r\\n        SigninLogs\\r\\n        | where isnotempty( IPAddress)\\r\\n                | summarize by IPAddress , Type, TimeGenerated\\r\\n    ) on $left.ip == $right.IPAddress  \\r\\n            | project ip, Type, TimeGenerated\\r\\n    ),\\r\\n    (\\r\\n    ThreatIntel\\r\\n    | join kind=inner (\\r\\n        _GetWatchlist('testindicators')\\r\\n        | where isnotempty(IPValue)\\r\\n                | summarize by IPValue\\r\\n    ) on $left.ip == $right.IPValue  \\r\\n            | project ip\\r\\n    ),\\r\\n    (\\r\\n    ThreatIntel\\r\\n    | join kind=inner (\\r\\n        AzureActivity\\r\\n        | where isnotempty( CallerIpAddress)\\r\\n                | summarize by CallerIpAddress , Type, TimeGenerated\\r\\n    ) on $left.ip == $right.CallerIpAddress \\r\\n        | project ip, Type, TimeGenerated\\r\\n    )\\r\\n\",\"size\":1,\"title\":\"Search IOC in historical data in Sentinel\",\"timeContext\":{\"durationMs\":2592000000},\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"\"],\"gridSettings\":{\"filter\":true}},\"name\":\"query - 10\",\"styleSettings\":{\"showBorder\":true}},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"hostname\",\"type\":1,\"isGlobal\":true,\"timeContext\":{\"durationMs\":86400000},\"value\":\"dancevida.com\"}],\"style\":\"pills\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"Hostcomponents\"},\"name\":\"parameters - 1\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"1.0.0\\\",\\\"content\\\":\\\"{\\\\r\\\\n\\\\\\\"hostname\\\\\\\":\\\\\\\"{hostname}\\\\\\\"\\\\r\\\\n}\\\",\\\"transformers\\\":null}\",\"size\":0,\"exportFieldName\":\"hostname\",\"exportParameterName\":\"hostname\",\"exportToExcelOptions\":\"all\",\"queryType\":8},\"conditionalVisibility\":{\"parameterName\":\"y\",\"comparison\":\"isEqualTo\",\"value\":\"n\"},\"name\":\"query - 3\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"CustomEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"POST\\\",\\\"url\\\":\\\"https://{AzureFunction}.azurewebsites.net/api/HostnameComponents?hostname='{hostname}'\\\",\\\"contentType\\\":\\\"application/json\\\",\\\"urlParams\\\":[],\\\"transformers\\\":[{\\\"type\\\":\\\"jsonpath\\\",\\\"settings\\\":{\\\"tablePath\\\":\\\"$.value\\\",\\\"columns\\\":[]}}]}\",\"size\":1,\"exportToExcelOptions\":\"all\",\"queryType\":10,\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"id\",\"formatter\":5}]},\"sortBy\":[]},\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"Hostcomponents\"},\"name\":\"query - 1\"}]},\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"Hostcomponents\"},\"name\":\"Hostcomponents - Copy\"}]},\"customWidth\":\"100\",\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"IpAddress\"},\"name\":\"IpAddresses-5\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"f04ba5f4-a808-4ce1-b90f-bf09a9b95f09\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"Hostname\",\"type\":1,\"isGlobal\":true,\"timeContext\":{\"durationMs\":86400000},\"value\":\"share.1drvmicrosoft.com\"}],\"style\":\"pills\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"parameters - 1\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"1.0.0\\\",\\\"content\\\":\\\"{\\\\r\\\\n\\\\\\\"Hostname\\\\\\\":\\\\\\\"{Hostname}\\\\\\\"\\\\r\\\\n}\\\",\\\"transformers\\\":null}\",\"size\":0,\"exportFieldName\":\"ipaddress\",\"exportParameterName\":\"ipaddress\",\"exportToExcelOptions\":\"all\",\"queryType\":8},\"conditionalVisibility\":{\"parameterName\":\"y\",\"comparison\":\"isEqualTo\",\"value\":\"n\"},\"name\":\"query - 3\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"CustomEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"GET\\\",\\\"url\\\":\\\"https://{AzureFunction}.azurewebsites.net/api/ReputationforHostname?hostname='{Hostname}'\\\",\\\"contentType\\\":\\\"text/plain\\\",\\\"urlParams\\\":[],\\\"transformers\\\":[{\\\"type\\\":\\\"jsonpath\\\",\\\"settings\\\":{\\\"tablePath\\\":\\\"$\\\",\\\"columns\\\":[{\\\"path\\\":\\\"$.classification\\\",\\\"columnid\\\":\\\"Classification\\\",\\\"columnType\\\":\\\"string\\\"},{\\\"path\\\":\\\"$.score\\\",\\\"columnid\\\":\\\"Score\\\",\\\"columnType\\\":\\\"long\\\"}]}}]}\",\"size\":4,\"queryType\":10,\"visualization\":\"tiles\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Score\",\"formatter\":8,\"formatOptions\":{\"min\":0,\"max\":100,\"palette\":\"greenRed\"}}]},\"sortBy\":[],\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"Classification\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Score\",\"formatter\":18,\"formatOptions\":{\"thresholdsOptions\":\"colors\",\"thresholdsGrid\":[{\"operator\":\">\",\"thresholdValue\":\"70\",\"representation\":\"redBright\",\"text\":\"{0}{1}\"},{\"operator\":\">\",\"thresholdValue\":\"50\",\"representation\":\"orange\",\"text\":\"{0}{1}\"},{\"operator\":\"Default\",\"thresholdValue\":null,\"text\":\"{0}{1}\"}],\"compositeBarSettings\":{\"labelText\":\"\",\"columnSettings\":[]}},\"numberFormat\":{\"unit\":17,\"options\":{\"style\":\"decimal\",\"maximumFractionDigits\":2,\"maximumSignificantDigits\":3}}},\"showBorder\":true,\"sortCriteriaField\":\"Score\",\"sortOrderField\":2,\"size\":\"auto\"}},\"customWidth\":\"15\",\"name\":\"query - 3 - Copy\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"CustomEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"POST\\\",\\\"url\\\":\\\"https://{AzureFunction}.azurewebsites.net/api/HostInformation?hostname={Hostname}\\\",\\\"contentType\\\":\\\"application/json\\\",\\\"urlParams\\\":[],\\\"transformers\\\":[{\\\"type\\\":\\\"jsonpath\\\",\\\"settings\\\":{\\\"tablePath\\\":\\\"$\\\",\\\"columns\\\":[{\\\"path\\\":\\\"$.id\\\",\\\"columnid\\\":\\\"name\\\"},{\\\"path\\\":\\\"$.firstSeenDateTime\\\",\\\"columnid\\\":\\\"firstSeenDateTime\\\"},{\\\"path\\\":\\\"$.lastSeenDateTime\\\",\\\"columnid\\\":\\\"lastSeenDateTime\\\"},{\\\"path\\\":\\\"$.countryOrRegion\\\",\\\"columnid\\\":\\\"countryOrRegion\\\"},{\\\"path\\\":\\\"$.netblock\\\",\\\"columnid\\\":\\\"netblock\\\"},{\\\"path\\\":\\\"$.hostingProvider\\\",\\\"columnid\\\":\\\"hostingProvider\\\"},{\\\"path\\\":\\\"$.autonomousSystem.name\\\",\\\"columnid\\\":\\\"ASN_name\\\"},{\\\"path\\\":\\\"$.autonomousSystem.number\\\",\\\"columnid\\\":\\\"ASN_number\\\"},{\\\"path\\\":\\\"$.autonomousSystem.organization\\\",\\\"columnid\\\":\\\"ASN_organization\\\"},{\\\"path\\\":\\\"$.autonomousSystem.value\\\",\\\"columnid\\\":\\\"ASN_value\\\"}]}}]}\",\"size\":0,\"exportToExcelOptions\":\"all\",\"queryType\":10,\"visualization\":\"map\",\"sortBy\":[],\"mapSettings\":{\"locInfo\":\"CountryRegion\",\"locInfoColumn\":\"countryOrRegion\",\"sizeSettings\":\"ASN_number\",\"sizeAggregation\":\"Count\",\"legendMetric\":\"ASN_number\",\"legendAggregation\":\"Count\",\"itemColorSettings\":{\"nodeColorField\":\"ASN_number\",\"colorAggregation\":\"Sum\",\"type\":\"heatmap\",\"heatmapPalette\":\"greenRed\"},\"numberFormatSettings\":{\"unit\":0,\"options\":{\"style\":\"decimal\"}}}},\"customWidth\":\"30\",\"name\":\"query - 1 - Copy\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"CustomEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"POST\\\",\\\"url\\\":\\\"https://{AzureFunction}.azurewebsites.net/api/ComponentsforHostname?hostname='{Hostname}'\\\",\\\"contentType\\\":\\\"application/json\\\",\\\"urlParams\\\":[],\\\"transformers\\\":[{\\\"type\\\":\\\"jsonpath\\\",\\\"settings\\\":{\\\"tablePath\\\":\\\"$.value\\\",\\\"columns\\\":[]}}]}\",\"size\":1,\"title\":\"Components\",\"exportToExcelOptions\":\"all\",\"queryType\":10,\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"id\",\"formatter\":5},{\"columnMatch\":\"name\",\"formatter\":18,\"formatOptions\":{\"thresholdsOptions\":\"colors\",\"thresholdsGrid\":[{\"operator\":\"contains\",\"thresholdValue\":\"Crypto\",\"representation\":\"redBright\",\"text\":\"{0}{1}\"},{\"operator\":\"contains\",\"thresholdValue\":\"Mark\",\"representation\":\"red\",\"text\":\"{0}{1}\"},{\"operator\":\"Default\",\"thresholdValue\":null,\"text\":\"{0}{1}\"}]}},{\"columnMatch\":\"category\",\"formatter\":18,\"formatOptions\":{\"thresholdsOptions\":\"colors\",\"thresholdsGrid\":[{\"operator\":\"contains\",\"thresholdValue\":\"Command and Control Server\",\"representation\":\"redBright\",\"text\":\"{0}{1}\"},{\"operator\":\"Default\",\"thresholdValue\":null,\"text\":\"{0}{1}\"}]}},{\"columnMatch\":\"TiLink\",\"formatter\":1,\"formatOptions\":{\"linkColumn\":\"name\",\"linkTarget\":\"Url\"},\"numberFormat\":{\"unit\":0,\"options\":{\"style\":\"decimal\"},\"emptyValCustomText\":\"https://prod.ti.trafficmanager.net/search/components/ips?category=JavaScript%20Library&query=CryptoJS&version=\"}}],\"filter\":true},\"sortBy\":[]},\"customWidth\":\"55\",\"name\":\"query - 1 - Copy\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"CustomEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"POST\\\",\\\"url\\\":\\\"https://{AzureFunction}.azurewebsites.net/api/HostInformation?hostname={Hostname}\\\",\\\"contentType\\\":\\\"application/json\\\",\\\"urlParams\\\":[],\\\"transformers\\\":[{\\\"type\\\":\\\"jsonpath\\\",\\\"settings\\\":{\\\"tablePath\\\":\\\"$\\\",\\\"columns\\\":[{\\\"path\\\":\\\"$.id\\\",\\\"columnid\\\":\\\"name\\\"},{\\\"path\\\":\\\"$.firstSeenDateTime\\\",\\\"columnid\\\":\\\"firstSeenDateTime\\\"},{\\\"path\\\":\\\"$.lastSeenDateTime\\\",\\\"columnid\\\":\\\"lastSeenDateTime\\\"},{\\\"path\\\":\\\"$.countryOrRegion\\\",\\\"columnid\\\":\\\"countryOrRegion\\\"},{\\\"path\\\":\\\"$.netblock\\\",\\\"columnid\\\":\\\"netblock\\\"},{\\\"path\\\":\\\"$.hostingProvider\\\",\\\"columnid\\\":\\\"hostingProvider\\\"},{\\\"path\\\":\\\"$.autonomousSystem.name\\\",\\\"columnid\\\":\\\"ASN_name\\\"},{\\\"path\\\":\\\"$.autonomousSystem.number\\\",\\\"columnid\\\":\\\"ASN_number\\\"},{\\\"path\\\":\\\"$.autonomousSystem.organization\\\",\\\"columnid\\\":\\\"ASN_organization\\\"},{\\\"path\\\":\\\"$.autonomousSystem.value\\\",\\\"columnid\\\":\\\"ASN_value\\\"}]}}]}\",\"size\":1,\"title\":\"Hostname Information\",\"exportToExcelOptions\":\"all\",\"queryType\":10,\"gridSettings\":{\"filter\":true},\"sortBy\":[]},\"customWidth\":\"45\",\"name\":\"query - 1\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"CustomEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"POST\\\",\\\"url\\\":\\\"https://{AzureFunction}.azurewebsites.net/api/ReputationforHostname?code=nKsXb5psrciZw8kC7DPKbwtzgJgyJUCVFzfwnsFcCWDqAzFuJwGeUg==&hostname='{Hostname}'\\\",\\\"contentType\\\":\\\"application/json\\\",\\\"urlParams\\\":[],\\\"transformers\\\":[{\\\"type\\\":\\\"jsonpath\\\",\\\"settings\\\":{\\\"tablePath\\\":\\\"$.rules\\\",\\\"columns\\\":[]}}]}\",\"size\":1,\"title\":\"Threat intelligence Details\",\"exportToExcelOptions\":\"all\",\"queryType\":10,\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"severity\",\"formatter\":18,\"formatOptions\":{\"thresholdsOptions\":\"colors\",\"thresholdsGrid\":[{\"operator\":\"contains\",\"thresholdValue\":\"medium\",\"representation\":\"orange\",\"text\":\"{0}{1}\"},{\"operator\":\"contains\",\"thresholdValue\":\"high\",\"representation\":\"redBright\",\"text\":\"{0}{1}\"},{\"operator\":\"contains\",\"thresholdValue\":\"low\",\"representation\":\"blue\",\"text\":\"{0}{1}\"},{\"operator\":\"Default\",\"thresholdValue\":null,\"text\":\"{0}{1}\"}]}},{\"columnMatch\":\"relatedDetailsUrl\",\"formatter\":7,\"formatOptions\":{\"linkTarget\":\"Url\"}},{\"columnMatch\":\"link\",\"formatter\":7,\"formatOptions\":{\"linkTarget\":\"Url\"}}],\"filter\":true,\"sortBy\":[{\"itemKey\":\"$gen_thresholds_severity_2\",\"sortOrder\":1}]},\"sortBy\":[{\"itemKey\":\"$gen_thresholds_severity_2\",\"sortOrder\":1}]},\"customWidth\":\"55\",\"name\":\"query - 1 - Copy\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"CustomEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"POST\\\",\\\"url\\\":\\\"https://{AzureFunction}.azurewebsites.net/api/CookiesforHostname?hostname='{Hostname}'\\\",\\\"contentType\\\":\\\"application/json\\\",\\\"urlParams\\\":[],\\\"transformers\\\":[{\\\"type\\\":\\\"jsonpath\\\",\\\"settings\\\":{\\\"tablePath\\\":\\\"$.value\\\",\\\"columns\\\":[]}}]}\",\"size\":1,\"title\":\"Hostname Cookies infromation\",\"queryType\":10},\"customWidth\":\"45\",\"name\":\"query - 8\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"CustomEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"POST\\\",\\\"url\\\":\\\"https://{AzureFunction}.azurewebsites.net/api/TrackersforHostname?hostname='{Hostname}'\\\",\\\"contentType\\\":\\\"application/json\\\",\\\"urlParams\\\":[],\\\"transformers\\\":[{\\\"type\\\":\\\"jsonpath\\\",\\\"settings\\\":{\\\"tablePath\\\":\\\"$.value\\\",\\\"columns\\\":[]}}]}\",\"size\":1,\"title\":\"Hostname Trackers\",\"queryType\":10,\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"kind\",\"formatter\":18,\"formatOptions\":{\"thresholdsOptions\":\"colors\",\"thresholdsGrid\":[{\"operator\":\"contains\",\"thresholdValue\":\"Jarm\",\"representation\":\"redBright\",\"text\":\"{0}{1}\"},{\"operator\":\"contains\",\"thresholdValue\":\"Mark\",\"representation\":\"red\",\"text\":\"{0}{1}\"},{\"operator\":\"Default\",\"thresholdValue\":null,\"text\":\"{0}{1}\"}]}}]}},\"customWidth\":\"55\",\"name\":\"query - 9\",\"styleSettings\":{\"showBorder\":true}},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"f04ba5f4-a808-4ce1-b90f-bf09a9b95f09\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"hostname\",\"type\":1,\"isGlobal\":true,\"timeContext\":{\"durationMs\":86400000},\"value\":\"dancevida.com\"}],\"style\":\"pills\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"Hostcomponents\"},\"name\":\"parameters - 1\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"1.0.0\\\",\\\"content\\\":\\\"{\\\\r\\\\n\\\\\\\"hostname\\\\\\\":\\\\\\\"{hostname}\\\\\\\"\\\\r\\\\n}\\\",\\\"transformers\\\":null}\",\"size\":0,\"exportFieldName\":\"hostname\",\"exportParameterName\":\"hostname\",\"exportToExcelOptions\":\"all\",\"queryType\":8},\"conditionalVisibility\":{\"parameterName\":\"y\",\"comparison\":\"isEqualTo\",\"value\":\"n\"},\"name\":\"query - 3\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"CustomEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"POST\\\",\\\"url\\\":\\\"https://{AzureFunction}.azurewebsites.net/api/HostnameComponents?hostname='{hostname}'\\\",\\\"contentType\\\":\\\"application/json\\\",\\\"urlParams\\\":[],\\\"transformers\\\":[{\\\"type\\\":\\\"jsonpath\\\",\\\"settings\\\":{\\\"tablePath\\\":\\\"$.value\\\",\\\"columns\\\":[]}}]}\",\"size\":1,\"exportToExcelOptions\":\"all\",\"queryType\":10,\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"id\",\"formatter\":5}]},\"sortBy\":[]},\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"Hostcomponents\"},\"name\":\"query - 1\"}]},\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"Hostcomponents\"},\"name\":\"Hostcomponents - Copy\"}]},\"customWidth\":\"100\",\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"HostName\"},\"name\":\"IpAddresses-5 - Copy\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"f04ba5f4-a808-4ce1-b90f-bf09a9b95f09\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"Hostname\",\"type\":1,\"isGlobal\":true,\"timeContext\":{\"durationMs\":86400000},\"value\":\"dancevida.com\"}],\"style\":\"pills\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"HostnameReputation\"},\"name\":\"parameters - 1\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"1.0.0\\\",\\\"content\\\":\\\"{\\\\r\\\\n\\\\\\\"hostname\\\\\\\":\\\\\\\"{Hostname}\\\\\\\"\\\\r\\\\n}\\\",\\\"transformers\\\":null}\",\"size\":0,\"exportFieldName\":\"Hostname\",\"exportParameterName\":\"Hostname\",\"exportToExcelOptions\":\"all\",\"queryType\":8},\"conditionalVisibility\":{\"parameterName\":\"y\",\"comparison\":\"isEqualTo\",\"value\":\"n\"},\"name\":\"query - 3\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"CustomEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"POST\\\",\\\"url\\\":\\\"https://{AzureFunction}.azurewebsites.net/api/HostnameReputation?Hostname='{Hostname}'\\\",\\\"contentType\\\":\\\"application/json\\\",\\\"urlParams\\\":[],\\\"transformers\\\":[{\\\"type\\\":\\\"jsonpath\\\",\\\"settings\\\":{\\\"tablePath\\\":\\\"$.rules\\\",\\\"columns\\\":[]}}]}\",\"size\":0,\"exportToExcelOptions\":\"all\",\"queryType\":10,\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"severity\",\"formatter\":18,\"formatOptions\":{\"thresholdsOptions\":\"icons\",\"thresholdsGrid\":[{\"operator\":\"==\",\"thresholdValue\":\"high\",\"representation\":\"4\",\"text\":\"{0}{1}\"},{\"operator\":\"==\",\"thresholdValue\":\"low\",\"representation\":\"1\",\"text\":\"{0}{1}\"},{\"operator\":\"==\",\"thresholdValue\":\"medium\",\"representation\":\"2\",\"text\":\"{0}{1}\"},{\"operator\":\"Default\",\"thresholdValue\":null,\"representation\":\"success\",\"text\":\"{0}{1}\"}]}},{\"columnMatch\":\"link\",\"formatter\":7}]},\"sortBy\":[]},\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"HostnameReputation\"},\"name\":\"query - 1\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"CustomEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"GET\\\",\\\"url\\\":\\\"https://{AzureFunction}.azurewebsites.net/api/HostnameReputation?Hostname='{Hostname}'\\\",\\\"contentType\\\":\\\"text/plain\\\",\\\"urlParams\\\":[],\\\"transformers\\\":[{\\\"type\\\":\\\"jsonpath\\\",\\\"settings\\\":{\\\"tablePath\\\":\\\"$\\\",\\\"columns\\\":[{\\\"path\\\":\\\"$.classification\\\",\\\"columnid\\\":\\\"Classification\\\"},{\\\"path\\\":\\\"$.score\\\",\\\"columnid\\\":\\\"Score\\\"}]}}]}\",\"size\":4,\"queryType\":10,\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Score\",\"formatter\":8,\"formatOptions\":{\"min\":0,\"max\":100,\"palette\":\"greenRed\"}}]}},\"name\":\"query - 3\"}]},\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"HostnameReputation\"},\"name\":\"Reputation for a Hostname\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"f04ba5f4-a808-4ce1-b90f-bf09a9b95f09\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"Ipaddress\",\"type\":1,\"isGlobal\":true,\"timeContext\":{\"durationMs\":86400000},\"value\":\"185.82.217.3\",\"label\":\"IPAddress\"}],\"style\":\"pills\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"IPReputation\"},\"name\":\"parameters - 1\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"1.0.0\\\",\\\"content\\\":\\\"{\\\\r\\\\n\\\\\\\"Ipaddress\\\\\\\":\\\\\\\"{Ipaddress}\\\\\\\"\\\\r\\\\n}\\\",\\\"transformers\\\":null}\",\"size\":0,\"exportFieldName\":\"Ipaddress\",\"exportParameterName\":\"Ipaddress\",\"exportToExcelOptions\":\"all\",\"queryType\":8},\"conditionalVisibility\":{\"parameterName\":\"y\",\"comparison\":\"isEqualTo\",\"value\":\"n\"},\"name\":\"query - 3\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"CustomEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"GET\\\",\\\"url\\\":\\\"https://{AzureFunction}.azurewebsites.net/api/IPReputation?Ipaddress='{Ipaddress}'\\\",\\\"contentType\\\":\\\"text/plain\\\",\\\"urlParams\\\":[],\\\"transformers\\\":[{\\\"type\\\":\\\"jsonpath\\\",\\\"settings\\\":{\\\"tablePath\\\":\\\"$\\\",\\\"columns\\\":[{\\\"path\\\":\\\"$.classification\\\",\\\"columnid\\\":\\\"Classification\\\",\\\"columnType\\\":\\\"string\\\"},{\\\"path\\\":\\\"$.score\\\",\\\"columnid\\\":\\\"Score\\\",\\\"columnType\\\":\\\"long\\\"}]}}]}\",\"size\":4,\"queryType\":10,\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Score\",\"formatter\":8,\"formatOptions\":{\"min\":0,\"max\":100,\"palette\":\"greenRed\"}}]},\"sortBy\":[]},\"customWidth\":\"20\",\"name\":\"query - 3\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"CustomEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"POST\\\",\\\"url\\\":\\\"https://{AzureFunction}.azurewebsites.net/api/IPReputation?Ipaddress='{Ipaddress}'\\\",\\\"contentType\\\":\\\"application/json\\\",\\\"urlParams\\\":[],\\\"transformers\\\":[{\\\"type\\\":\\\"jsonpath\\\",\\\"settings\\\":{\\\"tablePath\\\":\\\"$.rules\\\",\\\"columns\\\":[]}}]}\",\"size\":1,\"exportToExcelOptions\":\"all\",\"queryType\":10,\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"link\",\"formatter\":7,\"formatOptions\":{\"linkTarget\":\"Url\"}}]},\"sortBy\":[]},\"customWidth\":\"50\",\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"IPReputation\"},\"name\":\"query - 1\",\"styleSettings\":{\"showBorder\":true}}]},\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"IPReputation\"},\"name\":\"Reputation for a IP\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"f04ba5f4-a808-4ce1-b90f-bf09a9b95f09\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"hostname\",\"type\":1,\"isGlobal\":true,\"timeContext\":{\"durationMs\":86400000},\"value\":\"dancevida.com\"}],\"style\":\"pills\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"Hostcomponents\"},\"name\":\"parameters - 1\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"1.0.0\\\",\\\"content\\\":\\\"{\\\\r\\\\n\\\\\\\"hostname\\\\\\\":\\\\\\\"{hostname}\\\\\\\"\\\\r\\\\n}\\\",\\\"transformers\\\":null}\",\"size\":0,\"exportFieldName\":\"hostname\",\"exportParameterName\":\"hostname\",\"exportToExcelOptions\":\"all\",\"queryType\":8},\"conditionalVisibility\":{\"parameterName\":\"y\",\"comparison\":\"isEqualTo\",\"value\":\"n\"},\"name\":\"query - 3\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"CustomEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"POST\\\",\\\"url\\\":\\\"https://{AzureFunction}.azurewebsites.net/api/HostnameComponents?hostname='{hostname}'\\\",\\\"contentType\\\":\\\"application/json\\\",\\\"urlParams\\\":[],\\\"transformers\\\":[{\\\"type\\\":\\\"jsonpath\\\",\\\"settings\\\":{\\\"tablePath\\\":\\\"$.value\\\",\\\"columns\\\":[]}}]}\",\"size\":1,\"exportToExcelOptions\":\"all\",\"queryType\":10,\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"id\",\"formatter\":5}]},\"sortBy\":[]},\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"Hostcomponents\"},\"name\":\"query - 1\"}]},\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"Hostcomponents\"},\"name\":\"Hostcomponents\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"f04ba5f4-a808-4ce1-b90f-bf09a9b95f09\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"ipaddress\",\"type\":1,\"isGlobal\":true,\"timeContext\":{\"durationMs\":86400000},\"value\":\"20.20.20.20\"}],\"style\":\"pills\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"ipaddresscookies\"},\"name\":\"parameters - 1\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"1.0.0\\\",\\\"content\\\":\\\"{\\\\r\\\\n\\\\\\\"ipaddress \\\\\\\":\\\\\\\"{ipaddress}\\\\\\\"\\\\r\\\\n}\\\",\\\"transformers\\\":null}\",\"size\":0,\"exportFieldName\":\"ipaddress\",\"exportParameterName\":\"ipaddress\",\"exportToExcelOptions\":\"all\",\"queryType\":8},\"conditionalVisibility\":{\"parameterName\":\"y\",\"comparison\":\"isEqualTo\",\"value\":\"n\"},\"name\":\"query - 3\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"CustomEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"POST\\\",\\\"url\\\":\\\"https://{AzureFunction}.azurewebsites.net/api/Ipaddresscookies?ipaddress='{ipaddress}'\\\",\\\"contentType\\\":\\\"application/json\\\",\\\"urlParams\\\":[],\\\"transformers\\\":[{\\\"type\\\":\\\"jsonpath\\\",\\\"settings\\\":{\\\"tablePath\\\":\\\"$.value\\\",\\\"columns\\\":[]}}]}\",\"size\":1,\"exportToExcelOptions\":\"all\",\"queryType\":10,\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"id\",\"formatter\":5}]},\"sortBy\":[]},\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"ipaddresscookies\"},\"name\":\"query - 1\"}]},\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"ipaddresscookies\"},\"name\":\"IPAddressCookies \"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"f04ba5f4-a808-4ce1-b90f-bf09a9b95f09\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"host\",\"type\":1,\"isGlobal\":true,\"timeContext\":{\"durationMs\":86400000},\"value\":\"dancevida.com\"}],\"style\":\"pills\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"hostcookies\"},\"name\":\"parameters - 1\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"1.0.0\\\",\\\"content\\\":\\\"{\\\\r\\\\n\\\\\\\"host \\\\\\\":\\\\\\\"{host}\\\\\\\"\\\\r\\\\n}\\\",\\\"transformers\\\":null}\",\"size\":0,\"exportFieldName\":\"host\",\"exportParameterName\":\"host\",\"exportToExcelOptions\":\"all\",\"queryType\":8},\"conditionalVisibility\":{\"parameterName\":\"y\",\"comparison\":\"isEqualTo\",\"value\":\"n\"},\"name\":\"query - 3\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"CustomEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"POST\\\",\\\"url\\\":\\\"https://{AzureFunction}.azurewebsites.net/api/hostcookies?host='{host}'\\\",\\\"contentType\\\":\\\"application/json\\\",\\\"urlParams\\\":[],\\\"transformers\\\":[{\\\"type\\\":\\\"jsonpath\\\",\\\"settings\\\":{\\\"tablePath\\\":\\\"$.value\\\",\\\"columns\\\":[]}}]}\",\"size\":1,\"exportToExcelOptions\":\"all\",\"queryType\":10,\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"id\",\"formatter\":5}]},\"sortBy\":[]},\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"hostcookies\"},\"name\":\"query - 1\"}]},\"customWidth\":\"50\",\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"hostcookies\"},\"name\":\"hostcookies\",\"styleSettings\":{\"showBorder\":true}},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"f04ba5f4-a808-4ce1-b90f-bf09a9b95f09\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"host\",\"type\":1,\"isGlobal\":true,\"timeContext\":{\"durationMs\":86400000},\"value\":\"dancevida.com\"}],\"style\":\"pills\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"hostnametrackers\"},\"name\":\"parameters - 1\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"1.0.0\\\",\\\"content\\\":\\\"{\\\\r\\\\n\\\\\\\"host \\\\\\\":\\\\\\\"{host}\\\\\\\"\\\\r\\\\n}\\\",\\\"transformers\\\":null}\",\"size\":0,\"exportFieldName\":\"host\",\"exportParameterName\":\"host\",\"exportToExcelOptions\":\"all\",\"queryType\":8},\"conditionalVisibility\":{\"parameterName\":\"y\",\"comparison\":\"isEqualTo\",\"value\":\"n\"},\"name\":\"query - 3\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"CustomEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"POST\\\",\\\"url\\\":\\\"https://{AzureFunction}.azurewebsites.net/api/hostnametrackers?host='{host}'\\\",\\\"contentType\\\":\\\"application/json\\\",\\\"urlParams\\\":[],\\\"transformers\\\":[{\\\"type\\\":\\\"jsonpath\\\",\\\"settings\\\":{\\\"tablePath\\\":\\\"$.value\\\",\\\"columns\\\":[]}}]}\",\"size\":2,\"exportToExcelOptions\":\"all\",\"queryType\":10,\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"id\",\"formatter\":5}]},\"sortBy\":[]},\"customWidth\":\"50\",\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"hostnametrackers\"},\"name\":\"query - 1\",\"styleSettings\":{\"showBorder\":true}}]},\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"hostnametrackers\"},\"name\":\"hostcookies - Copy\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"f04ba5f4-a808-4ce1-b90f-bf09a9b95f09\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"ipaddress\",\"type\":1,\"isGlobal\":true,\"timeContext\":{\"durationMs\":86400000},\"value\":\"1.1.1.1\",\"label\":\"IP Address\"}],\"style\":\"pills\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"ipaddresstrackers\"},\"name\":\"parameters - 1\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"1.0.0\\\",\\\"content\\\":\\\"{\\\\r\\\\n\\\\\\\"ipaddress \\\\\\\":\\\\\\\"{ipaddress}\\\\\\\"\\\\r\\\\n}\\\",\\\"transformers\\\":null}\",\"size\":0,\"exportFieldName\":\"ipaddress\",\"exportParameterName\":\"ipaddress\",\"exportToExcelOptions\":\"all\",\"queryType\":8},\"conditionalVisibility\":{\"parameterName\":\"y\",\"comparison\":\"isEqualTo\",\"value\":\"n\"},\"name\":\"query - 3\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"CustomEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"POST\\\",\\\"url\\\":\\\"https://{AzureFunction}.azurewebsites.net/api/ipaddresstrackers?ipaddress='{ipaddress}'\\\",\\\"contentType\\\":\\\"application/json\\\",\\\"urlParams\\\":[],\\\"transformers\\\":[{\\\"type\\\":\\\"jsonpath\\\",\\\"settings\\\":{\\\"tablePath\\\":\\\"$.value\\\",\\\"columns\\\":[]}}]}\",\"size\":2,\"exportToExcelOptions\":\"all\",\"queryType\":10,\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"id\",\"formatter\":5}]},\"sortBy\":[]},\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"ipaddresstrackers\"},\"name\":\"query - 1\"}]},\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"ipaddresstrackers\"},\"name\":\"ipaddresstrackers\"}],\"isLocked\":false,\"fallbackResourceIds\":[\"azure monitor\"]}",
        "version": "1.0",
        "sourceId": "[parameters('workbookSourceId')]",
        "category": "[parameters('workbookType')]"
      }
    }
  ],
  "outputs": {
    "workbookId": {
      "type": "string",
      "value": "[resourceId( 'microsoft.insights/workbooks', parameters('workbookId'))]"
    }
  },
  "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"
}